{% extends 'base.html' %}
{% load static %}
{% load social_share %}
{% block title %} <title>Product</title> {% endblock %}
{% block stylesheets %}
<link rel="stylesheet" href="{% static 'css/index.css' %}">
<link rel="stylesheet" href="{% static 'css/product.css' %}">
{% endblock %}

{% block bread-page %}
<!-- <p class="bread-page body-white">ForHer</p> -->
<a class="bread-page body-white" href="{% url 'product:all-category' %}">All Products</a>
<i class="fas fa-chevron-right right-chev"></i>
<p class="bread-page body-white">{{product.product.name|truncatechars:21}}</p>
{% endblock %}

{% block bread-head %}
<p class="bread-head heading-2-white">#{{product.product.name}}</p>
{% endblock %}

{% block content %}
<div class="container">

  <!-- product details section -->
  <section class="product-details">
    <div class="col-md-12">
      <div class="row">
        <div class="col-md-6">
          <!-- product corousal -->
          <div id="product-image-corousal" class="carousel slide carousel-dark" data-bs-ride="carousel"
            data-bs-interval="false">
            <div class="carousel-indicators">
              {% if product.image1 %}
              <button id="cor-1" type="button" data-bs-target="#product-image-corousal" data-bs-slide-to="0"
                class="active cor-bottom-img" aria-current="true" aria-label="Slide 1"
                style="background: url({{product.image1.url}});"></button>
              {% endif %}
              {% if product.image2 %}
              <button id="cor-2" type="button" data-bs-target="#product-image-corousal" data-bs-slide-to="1"
                aria-label="Slide 2" style="background: url({{product.image2.url}});"></button>
              {% endif %}
              {% if product.image3 %}
              <button id="cor-3" type="button" data-bs-target="#product-image-corousal" data-bs-slide-to="2"
                aria-label="Slide 3" style="background: url({{product.image3.url}});"></button>
              {% endif %}
              {% if product.image4 %}
              <button id="cor-4" type="button" data-bs-target="#product-image-corousal" data-bs-slide-to="3"
                aria-label="Slide 4" style="background: url({{product.image4.url}});"></button>
              {% endif %}
              {% if product.image5 %}
              <button id="cor-5" type="button" data-bs-target="#product-image-corousal" data-bs-slide-to="4"
                aria-label="Slide 5" style="background: url({{product.image5.url}});"></button>
              {% endif %}

              {% for c in '12345' %}
              <style>
                #cor- {
                    {
                    c
                  }
                }

                  {
                  background-repeat: no-repeat !important;
                  background-size: cover !important;
                  /* border: none !important; */
                  height: 60px !important;
                  width: 60px !important;
                }
              </style>
              {% endfor %}
            </div>
            <div class="carousel-inner">
              {% if product.image1 %}
              <div class="carousel-item active">
                <img class="product-detail-image" src="{{product.image1.url}}" class="d-block w-100" alt="...">
              </div>
              {% else %}
              <img class="product-detail-image" src="{% static 'images/demo image.jpg' %}" alt="...">
              {% endif %}
              {% if product.image2 %}
              <div class="carousel-item">
                <img class="product-detail-image" src="{{product.image2.url}}" class="d-block w-100" alt="...">
              </div>
              {% endif %}
              {% if product.image3 %}
              <div class="carousel-item">
                <img class="product-detail-image" src="{{product.image3.url}}" class="d-block w-100" alt="...">
              </div>
              {% endif %}
              {% if product.image4 %}
              <div class="carousel-item">
                <img class="product-detail-image" src="{{product.image4.url}}" class="d-block w-100" alt="...">
              </div>
              {% endif %}
              {% if product.image5 %}
              <div class="carousel-item">
                <img class="product-detail-image" src="{{product.image5.url}}" class="d-block w-100" alt="...">
              </div>
              {% endif %}
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#product-image-corousal"
              data-bs-slide="prev">
              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
              <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#product-image-corousal"
              data-bs-slide="next">
              <span class="carousel-control-next-icon" aria-hidden="true"></span>
              <span class="visually-hidden">Next</span>
            </button>
          </div>
          <!-- product corousal -->

          <!-- social share -->
          <div class="product-social-share mb-2">
            <p style="color: black !important;">Share on Social Media:</p>
            <div class="row mt-2">
              <div class="row px-0 w-fit">

                <i class="fab fa-facebook-f w-fit ps-1 pe-1 my-auto"></i>
                {% post_to_facebook product.slug %}
                <!-- <p class="w-fit ps-1">Facebook</p> -->
              </div>
              <div class="row px-0 w-fit">
                <i class="fab fa-twitter w-fit ps-1 pe-1 my-auto"></i>
                {% post_to_twitter 'Found a cool product' product.slug %}
                <!-- <p class="w-fit ps-1">Twitter</p> -->
              </div>
              <div class="row px-0 w-fit">
                <i class="fab fa-whatsapp w-fit ps-1 pe-1 my-auto"></i>
                {% post_to_whatsapp product.slug %}
                <!-- <p class="w-fit ps-1">Instagram</p> -->
              </div>
            </div>
          </div>
          <!-- social share -->
        </div>
        <div class="col-md-6">
          <!-- product info row -->
          <p class="heading-2-black mt-3">{{product.product}}</p>
          <p class="body-black mt-2">
            {{product.product.description}}
          </p>
          <!-- rating row -->
          <div class="row mt-2 ">
            <input class="price-bar product-avg-rating-bar w-fit" type="range" value="{{rating}}" min="1" max="5">
            <p class="w-fit">Average rating of <span id="product-avg-rating">{{rating}}</span> out of 5</p>
          </div>
          <!-- features row -->
          <p class="mt-2 heading-3-regular-black">Features:</p>
          <ul>
            <li>{{product.product.feature1}}</li>
            <li>{{product.product.feature2}}</li>
            <li>{{product.product.feature3}}</li>
            <li>{{product.product.feature4}}</li>
            <li>{{product.product.feature5}}</li>
          </ul>
          <!-- colors row -->
          <div class="row mt-2">
            <p class="w-fit my-auto heading-3-regular-black ps-0">Colors: </p>

            <form id="color-variation-form" class="w-fit" action="{% url 'product:color-product' %}" method="POST">
              {% csrf_token %}
              {% for color in variation_colors %}
              <div class="form-check form-check-inline">
                <input class="form-check-input color-filter" name="color" type="checkbox" value="{{color}}"
                  id="pro-color{{forloop.counter}}">
              </div>
              <style>
                #pro-color {
                    {
                    forloop.counter
                  }
                }

                  {
                  background-color: {
                      {
                      color
                    }
                  }

                  ;
                }

                  {
                  % if product.color.colorCode==color %
                }

                #pro-color {
                    {
                    forloop.counter
                  }
                }

                  {
                  outline: 1px solid orange;
                }

                  {
                  % endif %
                }
              </style>
              {% endfor %}
              <input type="hidden" name="size" value="{{product.size.size}}">
              <input type="hidden" name="product" value="{{product.slug}}">
            </form>
            <!-- script to post form on color change -->
            <script>
              $(document).ready(function () {
                $(".color-filter").change(function () {
                  $("#color-variation-form").submit();
                });
              });
            </script>
          </div>
          <!-- sizes row -->
          <div class="row mt-2">
            <p class="w-fit heading-3-regular-black ps-0">Size: </p>
            <form id="size-product-form" class="w-fit my-auto" action="{% url 'product:size-product' %}" method="POST">
              {% csrf_token %}
              <select class="product-size-select" name="size" id="size-product">
                {% for size in variation_sizes %}
                {% if product.size.size == size %}
                <option value="{{size}}" selected>{{size}}</option>
                {% else %}
                <option value="{{size}}">{{size}}</option>
                {% endif %}
                {% endfor %}
              </select>
              <input type="hidden" name="product" value="{{product.slug}}">
              <input type="hidden" name="color" value="{{product.color}}">
            </form>
            <!-- script to post form on size change -->
            <script>
              $(document).ready(function () {
                $("#size-product").change(function () {
                  console.log($(this).val());
                  $("#size-product-form").submit();
                });
              });
            </script>
          </div>
          <!-- price info row -->
          <div class="row mt-2">
            <p class="w-fit heading-2-black product-page-price">${{product.discountPrice}}</p>
            {% if product.product.onSale %}
            <p class="w-fit body-italic-orange my-auto product-page-price-dis-info">Discount Price (actual price:
              <span>${{product.price}}</span> )</p>
            {% endif %}
          </div>
          <!-- add buttons row -->
          <div class="row mt-2">
            <!-- <form class="w-fit add-cart-product-page ps-0" action="{% url 'order:cart' %}" >
                        <input type="submit" class="simple-btn pro-add-btn body-white" value="Add To Cart">
                      </form> -->
            <form action="{% url 'order:add-to-cart' %}" method="POST" class="w-fit add-cart-product-page ps-0">
              {% csrf_token %}
              <input type="hidden" name="product-id" value="{{product.id}}">
              <input type="submit" class="simple-btn pro-add-btn body-white" value="Add To Cart">
            </form>

            <!-- add to wihslist form -->
            {% if not product.id in wish_items %}
            <form class="w-fit add-wish-product-page " action="{% url 'order:add-to-wishlist' %}" method="POST">
              {% csrf_token %}
              <input type="hidden" name="product-id" value="{{product.id}}">
              <input type="submit" class="simple-btn pro-add-btn body-white" value="Add To Wishlist">
            </form>
            {% else %}
            <a href="{% url 'order:wishlist' %}" class="simple-btn pro-add-btn added-btn body-white">Go to wishlist</a>
            {% endif %}
            <!-- add to wihslist form -->

          </div>
          <!-- add review row -->
          <div class="mt-4">
            <p class="heading-3-regular-black">Add Review</p>
            <form id="reviewForm" action="{% url 'product:post-review' %}" method="POST">
              {% csrf_token %}
              <div class="row mt-2">
                <p class="w-fit ps-0 ">Rating: </p>
                <input class="price-bar product-review-rating w-fit" name="rating" id="review-rate" type="range"
                  value="3" min="1" max="5">
                <p class="w-fit"> <span id="review-rate-span">3</span> out of 5 </p>
                <script>
                  $(document).ready(function () {
                    $("#review-rate").change(function () {
                      var newval = $(this).val();
                      $("#review-rate-span").html(newval);
                    });
                  });
                </script>
              </div>
              <div class="row pro-review-sub-row">
                <textarea name="review-text" id="product-review-text" rows="3"
                  placeholder="What do you think about the product?" class="product-review-box mt-2"></textarea>
                <input type="hidden" name="product" value="{{product.slug}}">
                <input type="submit" class="simple-btn review-submit-btn body-white" value="Submit Review">
              </div>
            </form>

          </div>
        </div>
      </div>
    </div>
  </section>
  <!-- product details section -->

  <!-- product review section -->
  <section class="product-reviews" style="margin-top: 2.8rem;">
    <div class="row">
      <p class="w-fit heading-2-black index-section-heading review-head">What others think</p>
      <p class="w-fit body-italic-black my-auto section-btn review-btn">Showing latest 4 reviews</p>
    </div>
    <div class="row product-review-row">
      {% if reviews %}
      {% for review in reviews %}
      <div class="prodcut-review-card">
        <div class="row">
          <p class="w-fit body-bold-black">User: </p>
          <p class="w-fit body-italic-black">{{review.user}}</p>
        </div>
        <div class="row">
          <p class="w-fit body-bold-black">Rating: </p>
          <p class="w-fit"> {{review.rating}} out of 5</p>
          <!-- <input type="range" min="1" max="5" value="{{review.rating}}" class="review-card-rating"> -->
        </div>
        <div class="row">
          <p class="w-fit body-bold-black">Review:</p>
          <p class="w-fit body-italic-black">{{review.review}}</p>
        </div>
      </div>
      {% endfor %}
      {% else %}
      <p class="w-fit body-italic-black">No reviews yet. Be the first to share a review.</p>
      {% endif %}
    </div>
  </section>
  <!-- product review section -->


  <!-- recently viewed section -->
  <section class="index-section section-gap">
    <div class="row">
      <p class="index-section-heading heading-2-black">Recently Viewed</p>
      <a class="index-section-button" href="">
        <p class="heading-3-regular-udl-orange section-btn">See all</p>
      </a>
    </div>

    <div class="row">
      {% for c in '1234' %}
      <div class="product-card">
        <div class="pr-card-img">
          <a class="card-img-btn" href="">
            <img class="product-img" src="{% static 'images/card 13.jpg' %}" alt="">
          </a>
          <div class="card-add-row">
            <a class="cart-add-icon" href="">
              <div class="row justify-content-center card-icons-bar">
                <i class="fas fa-plus card-icon"></i>
                <i class="fas fa-shopping-cart card-icon"></i>
              </div>
            </a>
            <a class="wish-add-icon" href="">
              <div class="row justify-content-center card-icons-bar">
                <i class="fas fa-plus card-icon"></i>
                <i class="fas fa-heart card-icon ms-1"></i>
              </div>
            </a>
          </div>
          <div class="card-sale-info text-center">
            <p class="heading-3-white cardsale-info">Sale</p>
          </div>
        </div>
        <div class="text-center">
          <a href="">
            <p class="heading-3-black card-heading-sm">Produt Name</p>
          </a>
          <p class="body-black product-info card-cat-sm">Category</p>
          <p class="heading-3-black product-info card-heading-sm">$10</p>
        </div>
      </div>
      {% endfor %}
    </div>
  </section>
  <!-- recently viewed section -->

  <!-- You migh also like section -->
  <section class="index-section section-gap">
    <div class="row">
      <p class="index-section-heading heading-2-black">You Might Also Like</p>
      <a class="index-section-button" href="">
        <p class="heading-3-regular-udl-orange section-btn">See all</p>
      </a>
    </div>

    <div class="row">
      {% for c in '1234' %}
      <div class="product-card">
        <div class="pr-card-img">
          <a class="card-img-btn" href="">
            <img class="product-img" src="{% static 'images/card 4.jpg' %}" alt="">
          </a>
          <div class="card-add-row">
            <a class="cart-add-icon" href="">
              <div class="row justify-content-center card-icons-bar">
                <i class="fas fa-plus card-icon"></i>
                <i class="fas fa-shopping-cart card-icon"></i>
              </div>
            </a>
            <a class="wish-add-icon" href="">
              <div class="row justify-content-center card-icons-bar">
                <i class="fas fa-plus card-icon"></i>
                <i class="fas fa-heart card-icon ms-1"></i>
              </div>
            </a>
          </div>
          <div class="card-sale-info text-center">
            <p class="heading-3-white cardsale-info">Sale</p>
          </div>
        </div>
        <div class="text-center">
          <a href="">
            <p class="heading-3-black card-heading-sm">Produt Name</p>
          </a>
          <p class="body-black product-info card-cat-sm">Category</p>
          <p class="heading-3-black product-info card-heading-sm">$10</p>
        </div>
      </div>
      {% endfor %}
    </div>
  </section>
  <!-- You migh also like section -->

  <!-- top selling section -->
  <section class="index-section section-gap">
    <div class="row">
      <p class="index-section-heading heading-2-black">Top Selling</p>
      <a class="index-section-button" href="">
        <p class="heading-3-regular-udl-orange section-btn">See all</p>
      </a>
    </div>

    <div class="row">
      {% for c in '1234' %}
      <div class="product-card">
        <div class="pr-card-img">
          <a class="card-img-btn" href="">
            <img class="product-img" src="{% static 'images/card 2.jpg' %}" alt="">
          </a>
          <div class="card-add-row">
            <a class="cart-add-icon" href="">
              <div class="row justify-content-center card-icons-bar">
                <i class="fas fa-plus card-icon"></i>
                <i class="fas fa-shopping-cart card-icon"></i>
              </div>
            </a>
            <a class="wish-add-icon" href="">
              <div class="row justify-content-center card-icons-bar">
                <i class="fas fa-plus card-icon"></i>
                <i class="fas fa-heart card-icon ms-1"></i>
              </div>
            </a>
          </div>
          <div class="card-sale-info text-center">
            <p class="heading-3-white cardsale-info">Sale</p>
          </div>
        </div>
        <div class="text-center">
          <a href="">
            <p class="heading-3-black card-heading-sm">Produt Name</p>
          </a>
          <p class="body-black product-info card-cat-sm">Category</p>
          <p class="heading-3-black product-info card-heading-sm">$10</p>
        </div>
      </div>
      {% endfor %}
    </div>
  </section>
  <!-- top selling section -->

</div>



{% endblock content %}